<html>
<head>
    <meta charset="UTF-8" />
    <title>Graphix</title>
    <style>
        body {margin: 0;}
        canvas {width: 100%; height: 100%}
    </style>
</head>
<body>
    <script src="js/three.js"></script>
    <script>
        var scene = new THREE.Scene(); 
        scene.background = new THREE.Color(0x009eb2);
        
        var camera = new THREE.PerspectiveCamera(90,  window.innerWidth / window.innerHeight, 0.1, 1000);
        var renderer = new THREE.WebGLRenderer();
        var player = { 
            height:1.8, //camera y
            speed:0.2,  //movement speed
            turnSpeed:Math.PI*0.02 //turning speed
        };
        
       
        
        function init(){
            makeLight();
            makeFloor();
            makeRoad();
            makePatrickHouse();
            camera.position.set(0, player.height, -5);
            camera.lookAt(new THREE.Vector3(0,player.height,0));

            renderer.setSize( window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.BasicShadowMap;
            document.body.appendChild(renderer.domElement);

            animate();
        }
        
        function makeLight(){
            var pointLight = new THREE.PointLight(0xffffff, 3);
            pointLight.position.set(50, 50, 30);
            pointLight.castShadow = true;
            pointLight.shadow.camera.near = 1;
            pointLight.shadow.camera.far = 30;
            scene.add(pointLight);
            
            var sphereSize = 6;
            var pointLightHelper = new THREE.PointLightHelper( pointLight, sphereSize );
            scene.add( pointLightHelper );
        }
        
        function makeFloor(){
            var floorGeometry =  new THREE.PlaneGeometry(500,500,10);
            var material =  new THREE.MeshPhongMaterial({
                            color:0x676948
            });
            var floor = new THREE.Mesh(floorGeometry, material);
            
            floor.rotation.x -= Math.PI / 2; // Rotate the floor
            scene.add(floor);
        }
        
        function makeRoad(){
            var roadGeometry = new THREE.PlaneGeometry(500, 10, 10);
            var material =  new THREE.MeshPhongMaterial({
                            color:0x242424
            });
            var road = new THREE.Mesh(roadGeometry, material);
            
            road.rotation.x -= Math.PI / 2; // Rotate the floor
            road.position.y += 0.03;
            scene.add(road);
        }
        
        function makePatrickHouse(){
            var sphereGeometry = new THREE.SphereGeometry(5, 32, 32);
            var material =  new THREE.MeshPhongMaterial({
                            color:0x4b010f
            });
            var patrickHouse = new THREE.Mesh(sphereGeometry, material);
            patrickHouse.position.x = 15;
            patrickHouse.position.z = 20;
            patrickHouse.position.y = 0;
            scene.add(patrickHouse);
            
            var pathGeometry = new THREE.PlaneGeometry(5, 18, 10);
            var material =  new THREE.MeshPhongMaterial({
                            color:0x242424
            });
            var path = new THREE.Mesh(pathGeometry, material);
            
            path.rotation.x -= Math.PI / 2; // Rotate the floor
            
            path.position.x = 15;
            path.position.z = 10;
            path.position.y += 0.03;
            scene.add(path);
        }

        function animate(){
            requestAnimationFrame(animate);

            // Keyboard movement inputs
//          if(keyboard[87] && ((camera.position.x <= 250 && camera.position.x >= -250) && (camera.position.z <= 250 && camera.position.z >= -250))){ // W with checking for collision DOES NOT WORK YET
            if(keyboard[87]){ // W
                camera.position.x -= Math.sin(camera.rotation.y) * player.speed;
                camera.position.z -= -Math.cos(camera.rotation.y) * player.speed;
            }
            if(keyboard[83]){ // S
                camera.position.x += Math.sin(camera.rotation.y) * player.speed;
                camera.position.z += -Math.cos(camera.rotation.y) * player.speed;
            }
            if(keyboard[65]){ // A
                camera.rotation.y -= player.turnSpeed;
            }
            if(keyboard[68]){ // D
                camera.rotation.y += player.turnSpeed;
            }

            renderer.render(scene, camera);
        }

        var keyboard = {};
        
        function keyDown(event){
            keyboard[event.keyCode] = true;
        }

        function keyUp(event){
            keyboard[event.keyCode] = false;
        }

        window.addEventListener('keydown', keyDown);
        window.addEventListener('keyup', keyUp);

        init();
    </script>
</body>
</html>